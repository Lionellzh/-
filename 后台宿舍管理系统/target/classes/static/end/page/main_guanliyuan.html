<!DOCTYPE html>
<html>
<head>
    <meta name="renderer" content="webkit"/>
    <meta name="force-rendering" content="webkit"/>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>学生宿舍管理系统</title>
    <link rel="stylesheet" href="../images/css/style.css">
    <link rel="stylesheet" href="../images/css/children.css">
    <link href="../images/aa/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../images/layui/css/layui.css">
    <script type="text/javascript" src="../images/js/jquery-1.11.0.min.js"></script>
</head>
<body class="layui-layout-body control_box">
<div id="wrapper">
    <div class="bg_box"
    ></div>
    <div class="layui-layout layui-layout-admin">
        <div class="layui-header">
            <div class="top_box">
                <div class="logo">
                    <img style="width: 500px;height: 70px;"src="../images/1122.png">
                    <span></span>
                </div>
                <div class="top_user">
                    <span><img src="../images/head1.jpg"/></span>
                    <dl>
                        <dt>{{user.username}} （{{user.level}} ）</dt>
                        <dd>
                            <script>
                                function tick() {
                                    var ye, mo, da
                                    var hours, minutes, seconds, xfile;
                                    var intHours, intMinutes, intSeconds;
                                    var today;
                                    today = new Date();
                                    ye = today.getFullYear();
                                    mo = today.getMonth() + 1;
                                    if (mo < 10) {
                                        mo = "0" + mo;
                                    }
                                    da = today.getDate();
                                    if (da < 10) {
                                        da = "0" + da;
                                    }
                                    intHours = today.getHours();
                                    intMinutes = today.getMinutes();
                                    intSeconds = today.getSeconds();
                                    if (intHours == 0) {
                                        hours = "12:";
                                        xfile = "PM";//午夜
                                    } else if (intHours < 12) {
                                        hours = intHours + ":";
                                        xfile = "AM";//上午
                                    } else if (intHours == 12) {
                                        hours = "12:";
                                        xfile = "PM";//正午
                                    } else {
                                        intHours = intHours - 12
                                        hours = intHours + ":";
                                        xfile = "PM";//下午
                                    }
                                    if (intHours < 10) {
                                        hours = "0" + intHours + ":";
                                    }
                                    if (intMinutes < 10) {
                                        minutes = "0" + intMinutes + ":";
                                    } else {
                                        minutes = intMinutes + ":";
                                    }
                                    if (intSeconds < 10) {
                                        seconds = "0" + intSeconds + " ";
                                    } else {
                                        seconds = intSeconds + " ";
                                    }
                                    var color, size, face, out;
                                    var text = "black";
                                    var font_size = 1;
                                    var font_face = "Arial";
                                    color = (text) ? text : "black";
                                    size = (font_size) ? font_size : 1;
                                    face = (font_face) ? font_face : "Arial";
                                    timeString = "<font style='font-size:14px;'>当前时间:";
                                    timeString += ye + "-" + mo + "-" + da + "  ";
                                    timeString += hours + minutes + seconds + " " + xfile + "&nbsp;&nbsp;&nbsp;";

                                    Clock.innerHTML = timeString;
                                    window.setTimeout("tick();", 100);
                                }

                                window.onload = tick;
                            </script>
                            <font id="Clock"
                                  style="font-size: 9pt; filter: dropshadow(color=#FFFFFF,offx=1,offy=1,positive=1);color: #ffffff;"
                                  align=center>&nbsp;
                            </font></dd>
                    </dl>
                </div>
                <div class="top_icon">
                    <a href="sy.html" title="桌面" target="hsgmain"><img src="../images/top_home.png"></a>
                    <!--	<a href="#" title="个人设置"><img src="../images/top_person.png"></a>-->
                    <a @click="logout" title="注销" style="cursor:pointer;"><img src="../images/top_exit.png"></a></div>
            </div>
        </div>
        <div class="layui-side layui-bg-black">
            <div class="layui-side-scroll">
                <ul class="layui-nav layui-nav-tree" lay-filter="test">


                    <li class="layui-nav-item">
                        <a href="javascript:;"><i class="fa fa-hsg1 fa-fw"></i>系统用户管理</a>
                        <dl class="layui-nav-child">
                            <dd><a href='yhzhgl.html' target='hsgmain'>管理员用户</a></dd>
                            <dd><a href='mod.html' target='hsgmain'>修改密码</a></dd>

                        </dl>
                    </li>
                    <li class="layui-nav-item">
                        <a href="javascript:;"><i class="fa fa-hsg2 fa-fw"></i>学生管理</a>
                        <dl class="layui-nav-child">
                            <dd><a href='xueshengxinxiInfo.html' target='hsgmain'>学生查询</a></dd>

                        </dl>
                    </li>
                    <li class="layui-nav-item">
                        <a href="javascript:;"><i class="fa fa-hsg3 fa-fw"></i>公告管理</a>
                        <dl class="layui-nav-child">
                            <dd><a href='gonggaoxinxiInfo.html' target='hsgmain'>公告查询</a></dd>

                        </dl>
                    </li>
                    <li class="layui-nav-item">
                        <a href="javascript:;"><i class="fa fa-hsg4 fa-fw"></i>报修管理</a>
                        <dl class="layui-nav-child">
                            <dd><a href='baoxiuxinxiInfo.html' target='hsgmain'>报修查询</a></dd>

                        </dl>
                    </li>
                    <li class="layui-nav-item">
                        <a href="javascript:;"><i class="fa fa-hsg5 fa-fw"></i>公共财务管理</a>
                        <dl class="layui-nav-child">
                            <dd><a href='gonggongcaiwuxinxiInfo.html' target='hsgmain'>公共财务查询</a></dd>

                        </dl>
                    </li>
                    <li class="layui-nav-item">
                        <a href="javascript:;"><i class="fa fa-hsg6 fa-fw"></i>缴费管理</a>
                        <dl class="layui-nav-child">
                            <dd><a href='jiaofeixinxiInfo.html' target='hsgmain'>缴费查询</a></dd>

                        </dl>
                    </li>
                    <li class="layui-nav-item">
                        <a href="javascript:;"><i class="fa fa-hsg7 fa-fw"></i>离校申请管理</a>
                        <dl class="layui-nav-child">
                            <dd><a href='lixiaoshenqingInfo.html' target='hsgmain'>离校申请查询</a></dd>

                        </dl>
                    </li>
                    <li class="layui-nav-item">
                        <a href="javascript:;"><i class="fa fa-hsg8 fa-fw"></i>宿舍评分管理</a>
                        <dl class="layui-nav-child">
                            <dd><a href='sushepingfenInfo.html' target='hsgmain'>宿舍评分查询</a></dd>

                        </dl>
                    </li>
                    <li class="layui-nav-item">
                        <a href="javascript:;"><i class="fa fa-hsg9 fa-fw"></i>上访信箱管理</a>
                        <dl class="layui-nav-child">
                            <dd><a href='shangfangxinxiangInfo.html' target='hsgmain'>上访信箱查询</a></dd>

                        </dl>
                    </li>


                </ul>
            </div>
        </div>
        <div class="layui-body">
            <div class="open_shrink open" title="展开/收起">
                <span></span></div>
            <script type="text/javascript">
                $(function () {
                    $(".open_shrink").click(function () {
                        if ($(this).hasClass("open")) {
                            $(this).removeClass("open");
                            $(".layui-side").stop().animate({left: -220}, 300);
                            $(".layui-body").stop().animate({left: 0}, 300);
                        } else {
                            $(this).addClass("open");
                            $(".layui-side").stop().animate({left: 0}, 300);
                            $(".layui-body").stop().animate({left: 220}, 300);
                        }
                    })
                })
            </script>
            <iframe src="sy.html" name="hsgmain" frameborder="0" class="layadmin-iframe" scrolling="yes"></iframe>
        </div>
    </div>
    <script src="../images/layui/layui.js"></script>
    <script>
        layui.use('element', function () {
            var element = layui.element;
        });
    </script>
</div>
<script src="../js/my.js"></script>
<script src="../js/vue2.6.11/vue.min.js"></script>
<script src="../js/vue2.6.11/axios.js"></script>
<script>
    new Vue({
        el: "#wrapper",
        data: {
            user: {},
            authority: [],
            totalUser: 0,
            totalComment: 0,
            totalPrice: 0,
            totalShopping: 0,
            echartsShowLeftArr: [],
            echartsShowRightArr: [],
            echartsType: 'pie'
        },
        created: function () {
            this.user = JSON.parse(localStorage.getItem("user"));

            axios.get("/authority").then(res => {
                if (res.data.code === '0') {
                    this.authority = res.data.data;
                } else {
                    msg('error', res.data.msg);
                }
            });

            axios.get("/echarts/getTotal").then(res => {
                if (res.data.code === '0') {
                    let map = res.data.data;
                    this.totalUser = map['totalUser'];
                    this.totalComment = map['totalComment'];
                    this.totalPrice = map['totalPrice'];
                    this.totalShopping = map['totalShopping'];
                }
            });

            this.drawLine();
        },
        methods: {
            drawLine() {
                axios.get('/echarts/get/price').then(res => {
                    // 基于准备好的dom，初始化echarts实例
                    this.echartsShowLeftArr = res.data.data;
                    if (this.echartsShowLeftArr.length) {
                        let myChart = echarts.init(document.getElementById('left'));
                        let option = this.getEchartsType(this.echartsShowLeftArr, this.echartsType);
                        myChart.setOption(option, true);
                    }
                });
                axios.get('/echarts/get/shopping').then(res => {
                    // 基于准备好的dom，初始化echarts实例
                    this.echartsShowRightArr = res.data.data;
                    if (this.echartsShowRightArr.length) {
                        let myChart = echarts.init(document.getElementById('right'));
                        let option = this.getEchartsType(this.echartsShowRightArr, this.echartsType);
                        myChart.setOption(option, true);
                    }
                });
            },
            selectEchartsType() {
                let leftChart = echarts.init(document.getElementById('left'));
                let leftOption = this.getEchartsType(this.echartsShowLeftArr, this.echartsType);
                leftChart.setOption(leftOption, true);

                let rightChart = echarts.init(document.getElementById('right'));
                let rightOption = this.getEchartsType(this.echartsShowRightArr, this.echartsType);
                rightChart.setOption(rightOption, true);
            },
            getEchartsType(echartsArr, type) {
                for (let item of echartsArr) {
                    if (item.series[0].type === type) {
                        return item;
                    }
                }
            },
            logout() {
                logout();
            }
        }
    });
</script>
</body>
</html>